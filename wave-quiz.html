<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transverse Wave Quiz</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  :root{
    --bg:#0a0e1a;--surface:#111827;--surface2:#1a2236;--accent:#00e5a0;
    --accent2:#00b4d8;--accent3:#f472b6;--danger:#ef4444;--gold:#fbbf24;
    --text:#e2e8f0;--muted:#64748b;--radius:16px;
  }
  body{
    font-family:'Outfit',sans-serif;background:var(--bg);color:var(--text);
    min-height:100vh;overflow-x:hidden;
    background-image:
      radial-gradient(ellipse 80% 60% at 50% -20%,rgba(0,229,160,.07),transparent),
      radial-gradient(ellipse 60% 50% at 80% 100%,rgba(0,180,216,.05),transparent);
  }
  .container{max-width:960px;margin:0 auto;padding:24px 20px}

  /* Header */
  .header{text-align:center;margin-bottom:32px;animation:fadeDown .6s ease}
  .header h1{
    font-size:clamp(1.8rem,4vw,2.6rem);font-weight:800;
    background:linear-gradient(135deg,var(--accent),var(--accent2));
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    letter-spacing:-1px;
  }
  .header p{color:var(--muted);margin-top:6px;font-size:.95rem;font-weight:300}

  /* Score bar */
  .score-bar{
    display:flex;align-items:center;justify-content:space-between;gap:16px;
    background:var(--surface);border:1px solid rgba(255,255,255,.06);
    border-radius:var(--radius);padding:14px 20px;margin-bottom:24px;
    animation:fadeDown .6s ease .1s both;
  }
  .score-bar .label{font-family:'Space Mono',monospace;font-size:.8rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px}
  .score-bar .value{font-family:'Space Mono',monospace;font-size:1.3rem;font-weight:700;color:var(--accent)}
  .score-bar .attempt-val{color:var(--accent2)}
  .score-bar .perfect{color:var(--gold)}

  /* Diagram card */
  .diagram-card{
    background:var(--surface);border:1px solid rgba(255,255,255,.06);
    border-radius:var(--radius);padding:28px 24px 20px;margin-bottom:24px;
    animation:fadeUp .6s ease .2s both;position:relative;overflow:hidden;
  }
  .diagram-card::before{
    content:'';position:absolute;top:0;left:0;right:0;height:3px;
    background:linear-gradient(90deg,var(--accent),var(--accent2),var(--accent3));
  }
  .diagram-card h2{font-size:1.1rem;font-weight:600;margin-bottom:16px;display:flex;align-items:center;gap:8px}
  .diagram-card h2 span{font-size:1.2rem}

  /* SVG styling */
  svg.wave-diagram{width:100%;height:auto;display:block}
  .wave-line{fill:none;stroke:url(#waveGrad);stroke-width:3.5;stroke-linecap:round}
  .eq-line{stroke:var(--muted);stroke-width:1;stroke-dasharray:8 6;opacity:.4}
  .marker-dot{cursor:pointer;transition:transform .2s,filter .2s}
  .marker-dot:hover{transform:scale(1.25);filter:drop-shadow(0 0 8px rgba(0,229,160,.6))}
  .marker-dot.correct circle{fill:var(--accent)!important;stroke:var(--accent)!important}
  .marker-dot.wrong circle{fill:var(--danger)!important;stroke:var(--danger)!important}
  .marker-dot.locked{pointer-events:none}
  .marker-label{
    font-family:'Space Mono',monospace;font-size:10px;fill:var(--muted);
    text-anchor:middle;pointer-events:none;
  }
  .marker-label.answer-show{fill:var(--accent);font-weight:700;font-size:11px}
  .marker-label.answer-wrong{fill:var(--danger);font-weight:700;font-size:11px}

  /* Dimension lines */
  .dim-line{stroke:var(--accent3);stroke-width:1.5;opacity:.7}
  .dim-arrow{fill:var(--accent3);opacity:.7}
  .dim-label-bg{fill:var(--surface);rx:4}

  /* Question panel */
  .question-panel{
    background:var(--surface);border:1px solid rgba(255,255,255,.06);
    border-radius:var(--radius);padding:24px;margin-bottom:24px;
    animation:fadeUp .6s ease .3s both;
  }
  .q-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
  .q-counter{font-family:'Space Mono',monospace;font-size:.75rem;color:var(--muted);letter-spacing:1px}
  .q-text{font-size:1.15rem;font-weight:500;line-height:1.5;margin-bottom:20px}
  .q-text em{color:var(--accent);font-style:normal;font-weight:700}

  /* Options grid */
  .options{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  @media(max-width:500px){.options{grid-template-columns:1fr}}
  .opt-btn{
    background:var(--surface2);border:2px solid rgba(255,255,255,.06);
    border-radius:12px;padding:12px 16px;font-family:'Outfit',sans-serif;
    font-size:.95rem;color:var(--text);cursor:pointer;transition:all .2s;
    text-align:left;position:relative;overflow:hidden;
  }
  .opt-btn:hover{border-color:var(--accent);background:rgba(0,229,160,.06)}
  .opt-btn.selected{border-color:var(--accent);background:rgba(0,229,160,.1);color:var(--accent);font-weight:600}
  .opt-btn.correct-reveal{border-color:var(--accent);background:rgba(0,229,160,.15);color:var(--accent)}
  .opt-btn.wrong-reveal{border-color:var(--danger);background:rgba(239,68,68,.1);color:var(--danger)}
  .opt-btn:disabled{cursor:default}

  /* Actions */
  .actions{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:8px}
  .btn{
    font-family:'Outfit',sans-serif;font-size:.95rem;font-weight:600;
    padding:12px 32px;border:none;border-radius:12px;cursor:pointer;transition:all .25s;
  }
  .btn-primary{
    background:linear-gradient(135deg,var(--accent),var(--accent2));color:var(--bg);
  }
  .btn-primary:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,229,160,.3)}
  .btn-secondary{background:var(--surface2);color:var(--text);border:1px solid rgba(255,255,255,.1)}
  .btn-secondary:hover{border-color:var(--accent)}
  .btn:disabled{opacity:.4;cursor:default;transform:none!important;box-shadow:none!important}

  /* Result overlay */
  .result-overlay{
    position:fixed;inset:0;background:rgba(10,14,26,.85);backdrop-filter:blur(12px);
    display:flex;align-items:center;justify-content:center;z-index:100;
    animation:fadeIn .3s ease;
  }
  .result-card{
    background:var(--surface);border:1px solid rgba(255,255,255,.08);
    border-radius:20px;padding:40px;text-align:center;max-width:440px;width:90%;
    animation:popIn .4s ease;
  }
  .result-card .emoji{font-size:3.5rem;margin-bottom:16px}
  .result-card h2{font-size:1.6rem;font-weight:700;margin-bottom:8px}
  .result-card .sub{color:var(--muted);margin-bottom:24px;line-height:1.6}
  .result-card .final-score{
    font-family:'Space Mono',monospace;font-size:2.4rem;font-weight:700;
    margin-bottom:24px;
  }
  .result-card .final-score.perfect{color:var(--gold)}
  .result-card .final-score.retry{color:var(--danger)}

  /* Feedback toast */
  .feedback{
    text-align:center;margin-top:14px;font-weight:600;font-size:1rem;
    animation:fadeIn .3s ease;
  }
  .feedback.correct{color:var(--accent)}
  .feedback.wrong{color:var(--danger)}

  /* Instructions */
  .instructions{
    background:var(--surface2);border-radius:12px;padding:14px 18px;
    font-size:.85rem;color:var(--muted);line-height:1.6;margin-bottom:20px;
    border-left:3px solid var(--accent);
  }

  /* Animations */
  @keyframes fadeDown{from{opacity:0;transform:translateY(-16px)}to{opacity:1;transform:translateY(0)}}
  @keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
  @keyframes fadeIn{from{opacity:0}to{opacity:1}}
  @keyframes popIn{from{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}
  @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.15)}}
  .pulse{animation:pulse .5s ease}

  /* Progress dots */
  .progress-dots{display:flex;gap:6px;align-items:center}
  .dot{
    width:10px;height:10px;border-radius:50%;background:var(--surface2);
    border:1.5px solid rgba(255,255,255,.1);transition:all .3s;
  }
  .dot.active{border-color:var(--accent2);background:var(--accent2);box-shadow:0 0 8px rgba(0,180,216,.4)}
  .dot.done-correct{background:var(--accent);border-color:var(--accent)}
  .dot.done-wrong{background:var(--danger);border-color:var(--danger)}
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>âš¡ Transverse Wave Quiz</h1>
    <p>Identify all parts of the wave â€” perfect score required to pass!</p>
  </div>

  <div class="score-bar">
    <div><div class="label">Score</div><div class="value" id="score">0 / 0</div></div>
    <div><div class="label">Attempt</div><div class="attempt-val value" id="attempt">1</div></div>
    <div><div class="label">Best</div><div class="perfect value" id="best">â€”</div></div>
  </div>

  <!-- Wave Diagram -->
  <div class="diagram-card">
    <h2><span>ðŸŒŠ</span> Transverse Wave Diagram</h2>
    <svg class="wave-diagram" viewBox="0 0 800 340" id="waveSvg">
      <defs>
        <linearGradient id="waveGrad" x1="0" y1="0" x2="800" y2="0" gradientUnits="userSpaceOnUse">
          <stop offset="0%" stop-color="#00e5a0"/>
          <stop offset="50%" stop-color="#00b4d8"/>
          <stop offset="100%" stop-color="#f472b6"/>
        </linearGradient>
      </defs>
      <!-- Equilibrium line -->
      <line class="eq-line" x1="40" y1="170" x2="760" y2="170"/>
      <text x="20" y="174" font-family="Space Mono,monospace" font-size="9" fill="#64748b" text-anchor="middle" transform="rotate(-90,20,170)">rest</text>

      <!-- Wave path -->
      <path class="wave-line" id="wavePath"/>

      <!-- Amplitude arrows (vertical) -->
      <line class="dim-line" x1="200" y1="170" x2="200" y2="70" id="ampLine1"/>
      <polygon class="dim-arrow" points="197,76 200,66 203,76"/>
      <polygon class="dim-arrow" points="197,164 200,174 203,164"/>

      <!-- Wavelength arrows (horizontal) -->
      <line class="dim-line" x1="200" y1="52" x2="600" y2="52" id="wlLine"/>
      <polygon class="dim-arrow" points="206,49 196,52 206,55"/>
      <polygon class="dim-arrow" points="594,49 604,52 594,55"/>

      <!-- Marker dots will be added by JS -->
    </svg>
  </div>

  <!-- Question Panel -->
  <div class="question-panel" id="questionPanel">
    <div class="instructions" id="instructions">
      Look at the wave diagram above. For each question, select the correct answer to identify the labeled part or measurement. You must get <strong>every question correct</strong> to pass!
    </div>
    <div class="q-header">
      <div class="q-counter" id="qCounter">QUESTION 1 / 7</div>
      <div class="progress-dots" id="progressDots"></div>
    </div>
    <div class="q-text" id="qText"></div>
    <div class="options" id="options"></div>
    <div class="feedback" id="feedback"></div>
    <div class="actions" style="margin-top:18px">
      <button class="btn btn-primary" id="nextBtn" disabled onclick="nextQuestion()">Next â†’</button>
    </div>
  </div>
</div>

<!-- Result overlay -->
<div class="result-overlay" id="resultOverlay" style="display:none">
  <div class="result-card">
    <div class="emoji" id="resEmoji"></div>
    <h2 id="resTitle"></h2>
    <p class="sub" id="resSub"></p>
    <div class="final-score" id="resFinalScore"></div>
    <button class="btn btn-primary" id="resBtn" onclick="handleResult()"></button>
  </div>
</div>

<script>
// Wave geometry
const W = 800, H = 340, midY = 170, amp = 100, startX = 40, endX = 760;
const waveLen = 400; // pixels per wavelength
const points = [];
const wavePath = document.getElementById('wavePath');

// Build wave path
let d = '';
for (let x = startX; x <= endX; x++) {
  const y = midY - amp * Math.sin(2 * Math.PI * (x - startX) / waveLen);
  if (x === startX) d += `M${x},${y}`;
  else d += ` L${x},${y}`;
  points.push({ x, y });
}
wavePath.setAttribute('d', d);

// Marker positions
const markers = [
  { id:'crest',       x:200, y:midY - amp, label:'A', color:'#00e5a0' },
  { id:'trough',      x:400, y:midY + amp, label:'B', color:'#00b4d8' },
  { id:'amplitude',   x:200, y:midY - amp/2, label:'C', color:'#f472b6', isArrow:true },
  { id:'wavelength',  x:400, y:52,          label:'D', color:'#fbbf24', isArrow:true },
  { id:'equilibrium', x:500, y:midY,        label:'E', color:'#a78bfa' },
  { id:'compression_point', x:600, y:midY - amp, label:'F', color:'#fb923c' },
  { id:'rest_to_trough', x:400, y:midY + amp/2, label:'G', color:'#38bdf8', isArrow:true },
];

// Draw markers on SVG
const svg = document.getElementById('waveSvg');
markers.forEach(m => {
  const g = document.createElementNS('http://www.w3.org/2000/svg','g');
  g.classList.add('marker-dot');
  g.id = 'marker-' + m.id;

  const circle = document.createElementNS('http://www.w3.org/2000/svg','circle');
  circle.setAttribute('cx', m.x);
  circle.setAttribute('cy', m.y);
  circle.setAttribute('r', m.isArrow ? 0 : 10);
  circle.setAttribute('fill', m.isArrow ? 'none' : 'rgba(0,0,0,.5)');
  circle.setAttribute('stroke', m.color);
  circle.setAttribute('stroke-width', m.isArrow ? 0 : 2.5);

  // Label box
  const rect = document.createElementNS('http://www.w3.org/2000/svg','rect');
  const labelYOffset = m.y < midY ? -22 : 18;
  rect.setAttribute('x', m.x - 11);
  rect.setAttribute('y', m.y + labelYOffset - 10);
  rect.setAttribute('width', 22);
  rect.setAttribute('height', 18);
  rect.setAttribute('rx', 4);
  rect.setAttribute('fill', m.color);
  rect.setAttribute('opacity', .9);

  const text = document.createElementNS('http://www.w3.org/2000/svg','text');
  text.setAttribute('x', m.x);
  text.setAttribute('y', m.y + labelYOffset + 3);
  text.setAttribute('text-anchor','middle');
  text.setAttribute('font-family','Space Mono, monospace');
  text.setAttribute('font-size','11');
  text.setAttribute('font-weight','700');
  text.setAttribute('fill','#0a0e1a');
  text.textContent = m.label;

  g.appendChild(circle);
  g.appendChild(rect);
  g.appendChild(text);
  svg.appendChild(g);
});

// Questions
const questions = [
  {
    text: 'Point <em>A</em> marks the highest point of the wave. What is this called?',
    marker: 'crest',
    options: ['Crest', 'Trough', 'Amplitude', 'Node'],
    answer: 0
  },
  {
    text: 'Point <em>B</em> marks the lowest point of the wave. What is this called?',
    marker: 'trough',
    options: ['Wavelength', 'Crest', 'Trough', 'Frequency'],
    answer: 2
  },
  {
    text: 'The vertical arrow <em>C</em> shows the maximum displacement from rest. What does it measure?',
    marker: 'amplitude',
    options: ['Wavelength', 'Period', 'Amplitude', 'Frequency'],
    answer: 2
  },
  {
    text: 'The horizontal arrow <em>D</em> spans one full cycle of the wave. What does it measure?',
    marker: 'wavelength',
    options: ['Amplitude', 'Wavelength', 'Period', 'Frequency'],
    answer: 1
  },
  {
    text: 'The dashed line at point <em>E</em> represents the wave\'s undisturbed position. What is it called?',
    marker: 'equilibrium',
    options: ['Crest line', 'Equilibrium (rest) position', 'Amplitude line', 'Phase line'],
    answer: 1
  },
  {
    text: 'Point <em>F</em> is the peak of the second cycle. It is identical in height to point A. What does this tell us?',
    marker: 'compression_point',
    options: [
      'The wave is getting stronger',
      'The wave repeats â€” crests recur each wavelength',
      'The frequency is increasing',
      'The wave is compressing'
    ],
    answer: 1
  },
  {
    text: 'Arrow <em>G</em> shows displacement from rest down to the trough. Its length equals the arrow at C. This confirms that the wave\'s _____ is the same above and below the rest position.',
    marker: 'rest_to_trough',
    options: ['Wavelength', 'Period', 'Frequency', 'Amplitude'],
    answer: 3
  }
];

// State
let currentQ = 0;
let correctCount = 0;
let attemptNum = 1;
let bestScore = null;
let answered = false;
let results = []; // track per-question

function init() {
  currentQ = 0;
  correctCount = 0;
  answered = false;
  results = [];
  document.getElementById('score').textContent = `0 / ${questions.length}`;
  document.getElementById('attempt').textContent = attemptNum;
  document.getElementById('instructions').style.display = attemptNum === 1 ? 'block' : 'none';
  buildProgressDots();
  showQuestion();
}

function buildProgressDots() {
  const container = document.getElementById('progressDots');
  container.innerHTML = '';
  questions.forEach((_, i) => {
    const dot = document.createElement('div');
    dot.className = 'dot' + (i === 0 ? ' active' : '');
    dot.id = 'dot-' + i;
    container.appendChild(dot);
  });
}

function showQuestion() {
  const q = questions[currentQ];
  document.getElementById('qCounter').textContent = `QUESTION ${currentQ + 1} / ${questions.length}`;
  document.getElementById('qText').innerHTML = q.text;
  document.getElementById('feedback').textContent = '';
  document.getElementById('nextBtn').disabled = true;
  answered = false;

  // Highlight current marker
  markers.forEach(m => {
    const el = document.getElementById('marker-' + m.id);
    el.style.opacity = m.id === q.marker ? 1 : .35;
  });

  // Shuffle option display but track correct index
  const optContainer = document.getElementById('options');
  optContainer.innerHTML = '';
  q.options.forEach((opt, i) => {
    const btn = document.createElement('button');
    btn.className = 'opt-btn';
    btn.textContent = opt;
    btn.onclick = () => selectAnswer(i, btn);
    btn.id = 'opt-' + i;
    optContainer.appendChild(btn);
  });

  // Update progress dots
  questions.forEach((_, i) => {
    const dot = document.getElementById('dot-' + i);
    dot.className = 'dot';
    if (i < currentQ) dot.classList.add(results[i] ? 'done-correct' : 'done-wrong');
    if (i === currentQ) dot.classList.add('active');
  });
}

function selectAnswer(idx, btn) {
  if (answered) return;
  answered = true;
  const q = questions[currentQ];
  const correct = idx === q.answer;

  // Disable all
  document.querySelectorAll('.opt-btn').forEach(b => b.disabled = true);

  if (correct) {
    correctCount++;
    btn.classList.add('correct-reveal');
    document.getElementById('feedback').className = 'feedback correct';
    document.getElementById('feedback').textContent = 'âœ“ Correct!';
    results.push(true);
  } else {
    btn.classList.add('wrong-reveal');
    document.getElementById('opt-' + q.answer).classList.add('correct-reveal');
    document.getElementById('feedback').className = 'feedback wrong';
    document.getElementById('feedback').textContent = 'âœ— Incorrect â€” the correct answer is highlighted.';
    results.push(false);
  }

  document.getElementById('score').textContent = `${correctCount} / ${questions.length}`;
  document.getElementById('nextBtn').disabled = false;
  document.getElementById('nextBtn').textContent = currentQ === questions.length - 1 ? 'See Results' : 'Next â†’';
}

function nextQuestion() {
  currentQ++;
  if (currentQ >= questions.length) {
    showResults();
    return;
  }
  showQuestion();
}

function showResults() {
  const perfect = correctCount === questions.length;
  if (bestScore === null || correctCount > bestScore) bestScore = correctCount;
  document.getElementById('best').textContent = `${bestScore} / ${questions.length}`;

  const overlay = document.getElementById('resultOverlay');
  overlay.style.display = 'flex';

  document.getElementById('resEmoji').textContent = perfect ? 'ðŸ†' : 'ðŸ”„';
  document.getElementById('resTitle').textContent = perfect ? 'Perfect Score!' : 'Not Quite!';
  document.getElementById('resSub').textContent = perfect
    ? 'Amazing! You identified every part of the transverse wave correctly.'
    : `You got ${correctCount} out of ${questions.length} correct. You need a perfect score to pass â€” review the diagram and try again!`;
  
  const scoreEl = document.getElementById('resFinalScore');
  scoreEl.textContent = `${correctCount} / ${questions.length}`;
  scoreEl.className = 'final-score ' + (perfect ? 'perfect' : 'retry');

  const btn = document.getElementById('resBtn');
  btn.textContent = perfect ? 'ðŸŽ‰ Play Again' : 'ðŸ” Retake Quiz';
  btn.className = perfect ? 'btn btn-primary' : 'btn btn-secondary';
}

function handleResult() {
  document.getElementById('resultOverlay').style.display = 'none';
  attemptNum++;
  // Reset markers opacity
  markers.forEach(m => {
    document.getElementById('marker-' + m.id).style.opacity = 1;
  });
  init();
}

// Start
init();
</script>
</body>
</html>
